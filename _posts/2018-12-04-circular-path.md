---
title: (공사중) 임의의 원형 경로 만들기
---

도입
----

2주 전, 사각형 Grid 에서 임의의 겹치지 않는 원형 경로를 구해야 하는 업무가 생겼습니다. 요구 조건은 다음과 같았습니다.

- 순환 경로 (처음 == 끝)
- 중복되지 않는 깨끗한 1픽셀의 line으로 이어질 것 (가급적 상하좌우로만)
- 약간의 랜덤성

문제 정의에 따라서 [A\*](<https://en.wikipedia.org/wiki/A*_search_algorithm>) 같은 탐색 알고리즘을 써서 구할 수도 있겠습니다만, 이때는 좀 쉽고 procedural 한 방법으로 풀어보고 싶다는 생각이 들었습니다. 고민 끝에 만든 방법은 다음과 같습니다.

1. 랜덤한 원형 영역 구하기
2. Cellular Automata 를 통해 영역 가장자리를 깨끗하게 만들기
3. 외곽선만 남긴 후 시작점과 끝점을 select 하고, DFS 로 경로 찾기

완성된 경로는 다음과 같습니다. (파란색=시작점)

![](<../images/circular_path_0.gif>)

그럼 하나씩 분석해 보겠습니다.


랜덤한 원형 영역 구하기
---------------------

위의 gif 파일을 보시면 알 수 있듯이 경로는 전체적으로 원형이지만 완벽한 원은 아닙니다. 약간 deform 된 원을 어떻게 표현할까 고민하다가 아주 옛날(10년 전쯤?)에 봤던 flash 파일이 하나 떠올랐습니다. 원주율($$\pi$$) 값을 알아내기 위해서 몬테카를로 방식을 이용해서 사분원에 점을 찍어보는 것입니다. 이 때 원의 반지름을 r 이라고 할 때, 아래와 같은 식으로 $$\pi$$ 값을 구할 수 있습니다.

$$
\frac{사분원 안에 들어간 점의 개수}{전체 점의 개수} \fallingdotseq \frac{\frac{\pi r^2}{4}}{r^2} = \frac{\pi}{4}
$$

원본은 찾을 수가 없어서 [비슷한 방법으로 원의 영역을 구해보는 youtube 영상의 링크](<https://www.youtube.com/watch?v=yF2V4sNYLCM>)를 추가해놓습니다.

그렇다면 이 아이디어처럼, 원형 영역을 구할 때 원의 영역과 겹치는 각 cell에 일정한 개수의 점을 찍어서, 해당 점들이 원에 속하는 개수만큼 확률값을 부여해서 최종적으로 해당 cell이 영역에 속하는지를 판단할 수 있지 않을까? 라고 생각했습니다. 원래 원에 포함되는 cell은 무조건 100% 확률로 영역에 속하겠지만, 가장자리에 걸치는 cell은 실행할 때마다 결과값이 달라집니다.

![](<../images/circular_path_1.gif>)



Cellular Automata 를 통해 영역 가장자리를 깨끗하게 만들기
------------------------------------------------------



외곽선만 남긴 후 시작점과 끝점을 select 하고, DFS 로 경로 찾기
----------------------------------------------------------
